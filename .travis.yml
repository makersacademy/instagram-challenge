lanugage: ruby
rvm: 2.5.0
branches:
  only:
    - '/.*/'
before_install:
  - gem update --system
  - gem install bundler
addons:
  postgresql: 9.6
env:
  - DB=pgsql
before_script:
  - bundle exec rake db:create
script:
  - bundle exec rake db:migrate RAILS_ENV=test
  - bundle exec rspec
  - bundle exec rake assets:precompile

after_success:
  - .travis/push.sh

matrix:
  fast_finish: true

deploy:
  provider: heroku
  api_key:
    secure: lMnZg7ZNB17DC1v06B/8XcPNK2Uotchqccn7f2nxGNpn7YLU4BiI9ZA7M1CxlA8vYLDJGP+tOfm9jeaaR7gj0OI2aGQjvRAgnwzcTYzNNgT2V69DREAwE0SxhgnP7ylYlLQRdoCS+oANqMVM/3pFH98QXDEzsuD3MJBBK47tL9mvo8NRt+q8ZXOTRewemhKyEqdNKk/3X5pfSDImh0WLF048a+d2agGe7q5X1byTG6d0j/4CB/mOXR9fDIAqWUOelTIquITOIRuBQdSNQBWLj+PKxO/bFrMLJ/v38CY2giqN8QnFqu+Fx+VYRv5CJEgegvPGAGJkKvKAM2yjUI3N/Om/6lE7fv4LMTdhCThBGbA+3IN5U3r8Dp8SPehPzRB6iaCg9bO6C14g3piBDRruZlLhe8LZ0KuifRl4HSbGNPNaI7LEsOZj9vJxHjqc0MWRkPII9sbCRuioowKYaevF+C4nZl/oYLVx7l2ldfliEZdr6aYbOsIskcdpWMq2tdGepuxqf0O780/M4YNiZkvKThrd8nYOahLZohvFfP9r3RrcLorjd6pgOQawjUs+dB5QIR+Q+8Sts3p4uPLNB3PK/ZXvcF6PaUtaLnWm5zoj1USctuRBqVYjEdYkIfIEkT422fmpMQ/jgSYONN8DoB7O7SHeZkP2CGFzig2ib5wFJeQ=
  app: fast-plains-43428
  on:
    repo: micosmin/instaclone
    branch: development
